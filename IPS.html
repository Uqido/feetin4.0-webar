<!DOCTYPE html>
<html lang="en" class="fullscreen-100">

<head>
    <meta charset="utf-8">
    <title>IPS</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/quiz.css">
    <link rel="stylesheet" href="css/hotspots.css">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="white" />
    <meta name="description" content="">
    <link rel="icon" type="image/png" href="favicon-uqido.png">

    <script src="https://unpkg.com/@webcomponents/webcomponentsjs/webcomponents-loader.js"></script>

    <script src="https://unpkg.com/intersection-observer/intersection-observer.js"></script>

    <script src="https://unpkg.com/resize-observer-polyfill/dist/ResizeObserver.js"></script>

    <script src="https://unpkg.com/fullscreen-polyfill/dist/fullscreen.polyfill.js"></script>

    <script src="https://unpkg.com/focus-visible/dist/focus-visible.js" defer></script>

    <script src="js/i18n/banana-i18n.js"></script>

    <script src="js/page-config.js"></script>

    <script src="https://use.fontawesome.com/releases/v5.15.4/js/all.js" data-auto-a11y="true"></script>
</head>

<body class="fullscreen-100">
    <div class="fullscreen-100" style="display:flex; flex-direction: column;">
        <div id="model-viewer-container" class="viewer">
            <model-viewer id="modelViewer" class='model-viewer' ar autoplay camera-controls src='models/IPS.glb' ios-src='models/IPS.usdz' alt='' noloop camera-orbit="150deg 70deg 100%" min-camera-orbit="auto 10deg 180%" max-camera-orbit="auto 90deg 190%" ar-modes="scene-viewer webxr quick-look"
                camera-target="-2m 0m -2.5m" min-field-of-view="60deg" max-field-of-view="60deg" exposure="1" shadow-intensity="1.5" shadow-softness="0.8" quick-look-browsers="safari chrome">
                <script src="js/LoadingBar.js"></script>
                <div id="hotspot-Nozzle" style="width: 24px;height: 24px" slot="hotspot-Nozzle" data-position="-2.7m 2m -2.7m" data-normal="0 1 0" data-visibility-attribute="visible" onclick="onPinClick('hotspot-Nozzle')">
                    <div data-i18n="hotspot-Nozzle" class="hotspot-pin-text text-white hotspot-content">
                        Head (extruder) with nozzle to extract polymers
                    </div>
                    <div class="hotspot-pin">
                    </div>
                    <!-- dot -->
                    <div class="pulse outer"></div>
                    <!-- pulse outer -->
                    <div class="pulse mid"></div>
                    <!-- pulse mid -->
                    <div class="pulse inner"></div>
                    <!-- pulse inner -->
                </div>
                <div id="hotspot-Platform" style="width: 24px;height: 24px" slot="hotspot-Platform" data-position="-2.7m 0.8m -2.7m" data-normal="0 1 0" data-visibility-attribute="visible" onclick="onPinClick('hotspot-Platform')">
                    <div data-i18n="hotspot-Platform" class="hotspot-pin-text text-white hotspot-content">
                        Platform moving down following the printing the object
                    </div>
                    <div class="hotspot-pin">
                    </div>
                    <!-- dot -->
                    <div class="pulse outer"></div>
                    <!-- pulse outer -->
                    <div class="pulse mid"></div>
                    <!-- pulse mid -->
                    <div class="pulse inner"></div>
                    <!-- pulse inner -->
                </div>
                <div id="hotspot-Filament" style="width: 24px;height: 24px" slot="hotspot-Filament" data-position="-2.7m 2.8m -2.7m" data-normal="0 1 0" data-visibility-attribute="visible" onclick="onPinClick('hotspot-Filament')">
                    <div data-i18n="hotspot-Filament" class="hotspot-pin-text text-white hotspot-content">
                        Filament of polymers
                    </div>
                    <div class="hotspot-pin">
                    </div>
                    <!-- dot -->
                    <div class="pulse outer"></div>
                    <!-- pulse outer -->
                    <div class="pulse mid"></div>
                    <!-- pulse mid -->
                    <div class="pulse inner"></div>
                    <!-- pulse inner -->
                </div>
                <div id="viewer-bottom" class="viewer-bottom">
                    <div id="move_camera" onclick="rotateCamera()" class="clickable" style="background-image: url(img/Move.png);"></div>
                    <div id="animate" onclick="model_Animate()" class="clickable" style="background-image: url(img/Animate.png);"></div>
                </div>
                <script>
                    const hideAndDisablePin = function() {
                        for (let annotation of window.annotations) {
                            annotation.classList.add("hide-child");
                            annotation.classList.remove("hide-pulse");
                        }

                        for (let annotation of window.annotations) {
                            annotation.style.display = "none"
                        }
                    }

                    const showAndEnablePin = function() {

                        for (let annotation of window.annotations) {
                            annotation.style.display = "block"
                        }
                    }


                    let is_Open = false;

                    function model_Animate() {
                        console.log("animate")
                        console.log(modelViewer.paused)
                        if (modelViewer.paused) {
                            if (is_Open) {
                                modelViewer.animationName = "Idle";
                                modelViewer.animationName = "Animation";
                                hideAndDisablePin()
                                is_Open = false;
                                const interval = setInterval(() => {
                                    if (modelViewer.paused) {
                                        clearInterval(interval);
                                        showAndEnablePin();
                                    }
                                }, 500);
                            } else {
                                modelViewer.animationName = "Idle";
                                modelViewer.animationName = "Animation";
                                hideAndDisablePin()
                                is_Open = true;
                                const interval = setInterval(() => {
                                    if (modelViewer.paused) {
                                        clearInterval(interval);
                                        showAndEnablePin();
                                    }
                                }, 500);
                            }
                            modelViewer.play();
                        }
                    }

                    document.addEventListener("page-configured", function(e) {
                        console.log("page configured!")
                        window.forceNoIframe = true;
                        window.forceAnnotations = true;

                        const annotations = window.hotspotsId.map((elem) => document.getElementById(elem));

                        annotations.forEach((element) => {
                            element.style.display = "none";
                        })

                        modelViewer.addEventListener('load', () => {
                            annotations.forEach((element) => {
                                element.style.display = "block";
                            })
                        });

                        window.annotations = annotations
                    });
                </script>
                <script src="js/ContentCustomizer.js"></script>
                <script>
                    document.addEventListener("page-configured", function(e) {

                        for (let annotation of window.annotations) {
                            annotation.classList.add("hide-child");
                        }
                        window.onPinClick = function(annotationID) {

                            const item = document.getElementById(annotationID);

                            if (!item.classList.contains("hide-child")) {
                                //it was already opened! closing
                                for (let annotation of annotations) {
                                    annotation.classList.add("hide-child");
                                    annotation.classList.remove("hide-pulse");
                                }
                                return;
                            }

                            for (let annotation of annotations) {
                                annotation.classList.add("hide-child");
                                annotation.classList.remove("hide-pulse");
                            }

                            item.classList.remove("hide-child")
                            item.classList.add("hide-pulse")
                        }

                    })
                </script>
            </model-viewer>
        </div>
        <div class="quiz">
            <div id="quiz">
                <div id="question" class="custom-title">
                </div>
                <div style=" display: grid; grid-template-columns: 2fr 2fr">
                    <div style="grid-column-start: 1" class="answer-grid-cell">
                        <div id="answer-1" class="answer-card" onclick="onAnswerClick(0)">
                        </div>
                    </div>
                    <div style="grid-column-start: 2" class="answer-grid-cell">
                        <div id="answer-2" class="answer-card" onclick="onAnswerClick(1)">
                        </div>
                    </div>
                    <div style="grid-column-start: 1; grid-row-start: 2" class="answer-grid-cell">
                        <div id="answer-3" class="answer-card" onclick="onAnswerClick(2)">
                        </div>
                    </div>
                    <div style="grid-column-start: 2; grid-row-start: 2" class="answer-grid-cell">
                        <div id="answer-4" class="answer-card" onclick="onAnswerClick(3)">
                        </div>
                    </div>
                </div>
            </div>
            <div id="recap" style="display: none">
                <div class="custom-title">
                    Session Recap
                </div>
                <div id="recap-message" class="recap-message">
                </div>
                <div class="restart-card answer-card" onclick="restartQuiz()">
                    Restart
                </div>
            </div>
        </div>
    </div>
    <script type="module" src="js/model-viewer/dist/1.8.0/model-viewer.min.js"></script>
    <script src="js/quiz.js"></script>
</body>

</html>